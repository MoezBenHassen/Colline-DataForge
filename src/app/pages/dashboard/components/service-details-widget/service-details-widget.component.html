<div class="card h-full">
    <div class="flex justify-between items-center mb-4">
        <h5 class="font-semibold text-xl">Performance Trends</h5>
        <!--                <p-selectButton [options]="timeRanges" [(ngModel)]="selectedTimeRange" optionLabel="label" optionValue="value" (onChange)="onTimeRangeChange()" styleClass="p-button-sm"> </p-selectButton>-->
    </div>
    @if (loading) {
        <div class="space-y-4">
            <!-- Skeleton for Metric Cards -->
            <div class="grid grid-cols-2 lg:grid-cols-4 gap-3">
                @for (i of [1, 2, 3, 4]; track i) {
                    <div class="p-3 rounded-lg bg-gray-50 dark:bg-gray-800">
                        <p-skeleton height="0.75rem" width="60%" styleClass="mb-2"></p-skeleton>
                        <p-skeleton height="1.5rem" width="80%"></p-skeleton>
                    </div>
                }
            </div>

            <!-- Skeleton for Health Indicators -->
            <div class="mb-4">
                <p-skeleton height="1rem" width="40%" styleClass="mb-2"></p-skeleton>
                <div class="grid grid-cols-3 gap-2">
                    @for (i of [1, 2, 3, 4, 5, 6]; track i) {
                        <p-skeleton height="2.25rem"></p-skeleton>
                    }
                </div>
            </div>

            <!-- Skeleton for Response Time Chart -->
            <div class="mb-4">
                <div class="flex items-center justify-between mb-2">
                    <p-skeleton height="1rem" width="40%"></p-skeleton>
                    <p-skeleton height="1.25rem" width="30%"></p-skeleton>
                </div>
                <p-skeleton height="120px" width="100%"></p-skeleton>
            </div>

            <!-- Skeleton for Action Buttons -->
            <div class="grid grid-cols-3 gap-2">
                <p-skeleton height="2.25rem"></p-skeleton>
                <p-skeleton height="2.25rem"></p-skeleton>
                <p-skeleton height="2.25rem"></p-skeleton>
            </div>
        </div>
    } @else {
        <div class="grid grid-cols-2 lg:grid-cols-4 gap-3 mb-4">
            @for (metric of serviceMetrics; track metric.label) {
                <div class="p-3 rounded-lg bg-gray-50 dark:bg-gray-800 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                    <div class="flex items-center justify-between mb-1">
                        <i [class]="'pi ' + metric.icon + ' text-' + metric.color + '-500'"></i>
                        @if (metric.trend) {
                            <div class="flex items-center text-xs" [ngClass]="getTrendClass(metric.trend)">
                                <i [class]="getTrendIcon(metric.trend)"></i>
                                <span class="ml-1">{{ metric.trendValue }}</span>
                            </div>
                        }
                    </div>
                    <div class="text-xs text-gray-600 dark:text-gray-400">{{ metric.label }}</div>
                    <div class="font-semibold text-lg text-gray-900 dark:text-white">{{ metric.value }}</div>
                </div>
            }
        </div>

        <div class="mb-4">
            <div class="flex items-center justify-between mb-2">
                <span class="text-sm font-medium text-gray-700 dark:text-gray-300">Health Indicators</span>
                <span class="text-xs text-gray-500">All Systems</span>
            </div>
            <div class="grid grid-cols-3 gap-2">
                @for (indicator of healthIndicators; track indicator.name) {
                    <div class="flex items-center justify-between p-2 rounded-lg" [ngClass]="getIndicatorBgClass(indicator.status)" [pTooltip]="indicator.tooltip" tooltipPosition="top">
                        <span class="text-xs font-medium">{{ indicator.name }}</span>
                        <i [class]="getIndicatorIcon(indicator.status)"></i>
                    </div>
                }
            </div>
        </div>

        <div class="mb-4">
            <div class="flex items-center justify-between mb-2">
                <span class="text-sm font-medium text-gray-700 dark:text-gray-300">Response Time (last hour)</span>
                <div class="flex items-center gap-2">
                    <span class="text-xs text-gray-500">Avg: {{ avgResponseTime }}ms</span>
                    <p-tag [value]="getResponseTimeStatus()" [severity]="getResponseTimeSeverity()" styleClass="text-xs px-2 py-0"></p-tag>
                </div>
            </div>
            <p-chart type="line" [data]="responseTimeChartData" [options]="responseTimeChartOptions" height="120px"></p-chart>
        </div>

        <div class="grid grid-cols-3 gap-2">
            <button pButton type="button" label="View Logs" icon="pi pi-file-text" class="p-button-sm p-button-outlined" pTooltip="View application logs" (click)="viewLogs()"></button>
            <button pButton type="button" label="Metrics" icon="pi pi-chart-bar" class="p-button-sm p-button-outlined" pTooltip="Detailed metrics"></button>
            <button pButton type="button" label="Restart" icon="pi pi-replay" class="p-button-sm p-button-danger p-button-outlined" pTooltip="Restart service" [disabled]="true"></button>
        </div>
    }
</div>
